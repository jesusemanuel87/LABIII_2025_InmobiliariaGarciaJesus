<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="700" viewBox="0 0 1000 700">
  <style>
    .title { font: bold 18px sans-serif; }
    .box { fill:#f7f7f9; stroke:#333; stroke-width:1; }
    .lifeline { stroke:#888; stroke-dasharray:4 4; }
    .arrow { stroke:#333; stroke-width:2; marker-end: url(#arrowhead); }
    .note { font: 12px monospace; fill:#222; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>

  <text x="20" y="30" class="title">Diagrama: Perfil (Ver / Editar / Cambiar contraseña)</text>

  <g transform="translate(20,60)">
    <rect x="0" y="0" width="120" height="32" class="box"/>
    <text x="10" y="22">Usuario</text>

    <rect x="150" y="0" width="160" height="32" class="box"/>
    <text x="160" y="22">PerfilFragment</text>

    <rect x="340" y="0" width="160" height="32" class="box"/>
    <text x="350" y="22">PerfilViewModel</text>

    <rect x="530" y="0" width="180" height="32" class="box"/>
    <text x="540" y="22">ApiClient / PropietarioApi</text>

    <rect x="730" y="0" width="140" height="32" class="box"/>
    <text x="740" y="22">SharedPrefs</text>

    <line x1="60" x2="60" y1="40" y2="600" class="lifeline"/>
    <line x1="230" x2="230" y1="40" y2="600" class="lifeline"/>
    <line x1="420" x2="420" y1="40" y2="600" class="lifeline"/>
    <line x1="620" x2="620" y1="40" y2="600" class="lifeline"/>
    <line x1="800" x2="800" y1="40" y2="600" class="lifeline"/>

    <text x="10" y="80" class="note">Usuario -> PerfilFragment: abrir sección</text>
    <line x1="230" y1="100" x2="420" y2="100" class="arrow" />
    <text x="240" y="94" class="note">cargarPerfil()</text>

    <line x1="420" y1="120" x2="620" y2="120" class="arrow" />
    <text x="430" y="114" class="note">GET /perfil (token)</text>

    <line x1="620" y1="140" x2="420" y2="140" class="arrow" />
    <text x="430" y="134" class="note">200 OK (Propietario)</text>

    <line x1="420" y1="160" x2="800" y2="160" class="arrow" />
    <text x="430" y="154" class="note">guardarPropietario()</text>

    <line x1="420" y1="180" x2="230" y2="180" class="arrow" />
    <text x="240" y="174" class="note">mPropietario.postValue()</text>

    <text x="10" y="220" class="note">Editar: PerfilFragment -> PerfilVM -> ApiClient -> actualizarPerfil()</text>
    <text x="10" y="240" class="note">Cambiar contraseña: Dialog -> ApiClient -> cambiarPassword()</text>

    <rect x="10" y="520" width="960" height="80" rx="6" ry="6" fill="#fff7e6" stroke="#cc9a00"/>
    <text x="30" y="550" class="note">Leyenda: ViewModel usa LiveData para notificar cambios (mPropietario, mModoEdicion, mError, etc.).</text>
  </g>
</svg>